<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>台海戰略模擬原型</title>
    <style>
        body { font-family: 'Microsoft JhengHei', sans-serif; background-color: #222; color: #fff; display: flex; flex-direction: column; align-items: center; }
        h1 { margin-top: 20px; }
        
        /* 遊戲區域 */
        #game-board {
            display: flex;
            justify-content: space-between;
            width: 800px;
            margin-top: 30px;
            padding: 20px;
            background-color: #333;
            border-radius: 10px;
        }

        .faction {
            width: 45%;
            padding: 20px;
            border: 2px solid #555;
            text-align: center;
            border-radius: 8px;
        }

        .faction.blue { border-color: #4da6ff; background: rgba(0, 0, 255, 0.1); }
        .faction.red { border-color: #ff4d4d; background: rgba(255, 0, 0, 0.1); }

        .stat { font-size: 1.2rem; margin: 10px 0; }
        
        /* 控制區 */
        #controls { margin-top: 20px; }
        button {
            padding: 10px 20px;
            font-size: 1rem;
            cursor: pointer;
            background-color: #444;
            color: white;
            border: 1px solid #666;
            margin: 0 5px;
            transition: 0.3s;
        }
        button:hover { background-color: #666; }
        
        #log {
            margin-top: 20px;
            width: 800px;
            height: 150px;
            background: #000;
            overflow-y: scroll;
            padding: 10px;
            font-family: monospace;
            border: 1px solid #444;
            color: #0f0;
        }
    </style>
</head>
<body>

    <h1>台海戰略模擬 (Web Prototype)</h1>

    <div id="game-board">
        <div class="faction blue">
            <h2>防守方 (Blue)</h2>
            <div class="stat">兵力: <span id="blue-units">10000</span></div>
            <div class="stat">防空網: <span id="blue-defense">100%</span></div>
            <div class="stat">士氣: <span id="blue-morale">100</span></div>
        </div>

        <div class="faction red">
            <h2>進攻方 (Red)</h2>
            <div class="stat">兵力: <span id="red-units">50000</span></div>
            <div class="stat">兩棲能力: <span id="red-landing">100%</span></div>
            <div class="stat">後勤: <span id="red-supply">100</span></div>
        </div>
    </div>

    <div id="controls">
        <button onclick="simulateTurn('air_raid')">紅軍：空襲</button>
        <button onclick="simulateTurn('missile_defense')">藍軍：飛彈攔截</button>
        <button onclick="simulateTurn('amphibious')">紅軍：登陸作戰</button>
        <button onclick="resetGame()">重置局勢</button>
    </div>

    <div id="log" id="battle-log"></div>

    <script>
        // 遊戲狀態數據
        let gameState = {
            blue: { units: 10000, defense: 100, morale: 100 },
            red: { units: 50000, landing: 100, supply: 100 }
        };

        // 更新畫面 UI
        function updateUI() {
            document.getElementById('blue-units').innerText = gameState.blue.units;
            document.getElementById('blue-defense').innerText = gameState.blue.defense + '%';
            document.getElementById('blue-morale').innerText = gameState.blue.morale;
            
            document.getElementById('red-units').innerText = gameState.red.units;
            document.getElementById('red-landing').innerText = gameState.red.landing + '%';
            document.getElementById('red-supply').innerText = gameState.red.supply;
        }

        // 寫入戰鬥日誌
        function logMessage(msg) {
            const logDiv = document.getElementById('log');
            const p = document.createElement('div');
            p.innerText = `> ${msg}`;
            logDiv.prepend(p);
        }

        // 模擬回合邏輯
        function simulateTurn(action) {
            // 檢查遊戲是否結束
            if (gameState.blue.units <= 0 || gameState.blue.morale <= 0) {
                logMessage("【戰報】防守方崩潰，進攻方獲勝。");
                return;
            }
            if (gameState.red.units <= 0 || gameState.red.supply <= 0) {
                logMessage("【戰報】進攻方兵力耗盡，防守成功。");
                return;
            }

            // 簡單的亂數計算
            let roll = Math.random();

            if (action === 'air_raid') {
                logMessage("紅軍發動空襲...");
                if (roll > 0.4) {
                    let dmg = Math.floor(Math.random() * 500);
                    let defDmg = Math.floor(Math.random() * 10);
                    gameState.blue.units -= dmg;
                    gameState.blue.defense -= defDmg;
                    logMessage(`空襲成功！造成藍軍 ${dmg} 單位損失，防空網受損 ${defDmg}%`);
                } else {
                    let loss = Math.floor(Math.random() * 100);
                    gameState.red.units -= loss;
                    logMessage(`空襲遭遇強烈抵抗，紅軍損失 ${loss} 單位。`);
                }
            } 
            else if (action === 'missile_defense') {
                logMessage("藍軍啟動飛彈防禦系統...");
                gameState.blue.defense = Math.min(100, gameState.blue.defense + 10);
                gameState.red.supply -= 5;
                logMessage("防空網修復中，消耗敵方後勤。");
            }
            else if (action === 'amphibious') {
                logMessage("紅軍嘗試登陸作戰...");
                if (gameState.blue.defense > 50) {
                    let loss = Math.floor(Math.random() * 1000);
                    gameState.red.units -= loss;
                    logMessage(`登陸失敗！因為藍軍防空與制海權尚存，紅軍損失 ${loss} 單位。`);
                } else {
                    let dmg = Math.floor(Math.random() * 2000);
                    gameState.blue.units -= dmg;
                    gameState.blue.morale -= 20;
                    logMessage(`登陸成功！建立灘頭堡，藍軍損失 ${dmg} 單位，士氣大跌。`);
                }
            }

            // 邊界檢查
            if(gameState.blue.units < 0) gameState.blue.units = 0;
            if(gameState.red.units < 0) gameState.red.units = 0;
            
            updateUI();
        }

        function resetGame() {
            gameState = {
                blue: { units: 10000, defense: 100, morale: 100 },
                red: { units: 50000, landing: 100, supply: 100 }
            };
            document.getElementById('log').innerHTML = '';
            logMessage("遊戲已重置。");
            updateUI();
        }

        // 初始化
        updateUI();
        logMessage("模擬系統啟動。等待指令...");
    </script>
</body>
</html>
